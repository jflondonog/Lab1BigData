{"paragraphs":[{"text":"%spark2.pyspark\nfrom pyspark.sql import SparkSession\nspark=SparkSession.builder.appName('data_processing').getOrCreate()\ndf=spark.read.csv('hdfs:///user/jflondonog/ssh/spark/Casos_positivos_de_COVID-19_en_Colombia.csv',inferSchema=True,header=True)\n\ndf = df.withColumnRenamed(df.columns[2], 'fechanotificacion')\ndf = df.withColumnRenamed(df.columns[4], 'departamento')\ndf = df.withColumnRenamed(df.columns[6], 'ciudad')\ndf = df.withColumnRenamed('Edad', 'edad')\ndf = df.withColumnRenamed(df.columns[0], 'fechareporte')\ndf = df.withColumnRenamed(df.columns[1], 'idcaso')\ndf = df.withColumnRenamed(df.columns[3], 'coddivipola-dep')\ndf = df.withColumnRenamed(df.columns[5], 'coddivipola-ciudad')\ndf = df.withColumnRenamed(df.columns[8], 'unidadmedida-edad')\ndf = df.withColumnRenamed(df.columns[10], 'tipocontagio')\ndf = df.withColumnRenamed(df.columns[11], 'ubicacioncaso')\ndf = df.withColumnRenamed(df.columns[13], 'codISOpais')\ndf = df.withColumnRenamed(df.columns[14], 'pais')\ndf = df.withColumnRenamed(df.columns[16], 'fechainiciosintomas')\ndf = df.withColumnRenamed(df.columns[17], 'fechamuerte')\ndf = df.withColumnRenamed(df.columns[18], 'fechadiagnostico')\ndf = df.withColumnRenamed(df.columns[19], 'fecharecuperacion')\ndf = df.withColumnRenamed(df.columns[20], 'tiporecuperacion')\ndf = df.withColumnRenamed(df.columns[21], 'pertenenciaetnica')\ndf = df.withColumnRenamed(df.columns[22], 'nombregpetnico')\n\ndf.createOrReplaceTempView(\"covidcolombia\")\n","user":"jflondonog","dateUpdated":"2021-06-07T20:43:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=387","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=388"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1623096463883_800732024","id":"20210607-200743_496724113","dateCreated":"2021-06-07T20:07:43+0000","dateStarted":"2021-06-07T20:43:10+0000","dateFinished":"2021-06-07T20:43:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3439"},{"text":"%spark2.pyspark\n#4.1 10 departamentos más contagiados\ndfdpto = spark.sql(\"SELECT departamento, COUNT(departamento) FROM covidcolombia GROUP BY departamento ORDER BY COUNT(departamento) DESC LIMIT 10\")\ndfdpto.show()\nwrite_uri='hdfs:///user/jflondonog/lab4/4.1_csv'\ndfdpto.coalesce(1).write.format(\"csv\").option(\"header\",\"true\").save(write_uri)","user":"jflondonog","dateUpdated":"2021-06-07T20:43:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-------------------+\n|departamento|count(departamento)|\n+------------+-------------------+\n|      BOGOTA|             951083|\n|   ANTIOQUIA|             536911|\n|       VALLE|             266414|\n|BARRANQUILLA|             172295|\n|CUNDINAMARCA|             159489|\n|   SANTANDER|             131547|\n|   ATLANTICO|              98667|\n|   CARTAGENA|              82165|\n|      TOLIMA|              75295|\n|      CALDAS|              70733|\n+------------+-------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=389","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=390"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1623096506504_1468091442","id":"20210607-200826_981944638","dateCreated":"2021-06-07T20:08:26+0000","dateStarted":"2021-06-07T20:43:18+0000","dateFinished":"2021-06-07T20:43:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3440"},{"text":"%spark2.pyspark\n#4.2 10 ciudades más contagiados\ndfciudad = spark.sql(\"SELECT ciudad, COUNT(ciudad) FROM covidcolombia GROUP BY ciudad ORDER BY COUNT(ciudad) DESC LIMIT 10\")\ndfciudad.show()\nwrite_uri='hdfs:///user/jflondonog/lab4/4.2_csv'\ndfciudad.coalesce(1).write.format(\"csv\").option(\"header\",\"true\").save(write_uri)","user":"jflondonog","dateUpdated":"2021-06-07T20:43:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-------------+\n|      ciudad|count(ciudad)|\n+------------+-------------+\n|      BOGOTA|       951083|\n|    MEDELLIN|       302031|\n|        CALI|       186219|\n|BARRANQUILLA|       172295|\n|   CARTAGENA|        82165|\n| BUCARAMANGA|        58111|\n|      IBAGUE|        53481|\n|   MANIZALES|        50331|\n| SANTA MARTA|        49623|\n|     SOLEDAD|        48905|\n+------------+-------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=391","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=392"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1623097392438_-120869875","id":"20210607-202312_1522817619","dateCreated":"2021-06-07T20:23:12+0000","dateStarted":"2021-06-07T20:43:34+0000","dateFinished":"2021-06-07T20:43:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3441"},{"text":"%spark2.pyspark\n#4.3 10 días más contagios\ndfdias = spark.sql(\"SELECT fechanotificacion, COUNT(fechanotificacion) FROM covidcolombia GROUP BY fechanotificacion ORDER BY COUNT(fechanotificacion) DESC LIMIT 10\")\ndfdias.show()\nwrite_uri='hdfs:///user/jflondonog/lab4/4.3_csv'\ndfdias.coalesce(1).write.format(\"csv\").option(\"header\",\"true\").save(write_uri)","user":"jflondonog","dateUpdated":"2021-06-07T20:43:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+------------------------+\n| fechanotificacion|count(fechanotificacion)|\n+------------------+------------------------+\n| 20/1/2021 0:00:00|                   24276|\n| 12/1/2021 0:00:00|                   22400|\n| 19/4/2021 0:00:00|                   21646|\n|  4/1/2021 0:00:00|                   21619|\n| 13/1/2021 0:00:00|                   21223|\n|  5/1/2021 0:00:00|                   21172|\n| 16/4/2021 0:00:00|                   21136|\n|  7/1/2021 0:00:00|                   20803|\n|  8/1/2021 0:00:00|                   20582|\n|28/12/2020 0:00:00|                   20199|\n+------------------+------------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=393","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=394"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1623097408074_475055826","id":"20210607-202328_442422746","dateCreated":"2021-06-07T20:23:28+0000","dateStarted":"2021-06-07T20:43:51+0000","dateFinished":"2021-06-07T20:44:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3442"},{"text":"%spark2.pyspark\n#4.4 Distribución de edades\ndfedad = spark.sql(\"SELECT edad, COUNT(edad) FROM covidcolombia GROUP BY edad ORDER BY edad DESC LIMIT 120\")\ndfedad.show()\nwrite_uri='hdfs:///user/jflondonog/lab4/4.4_csv'\ndfedad.coalesce(1).write.format(\"csv\").option(\"header\",\"true\").save(write_uri)\n","user":"jflondonog","dateUpdated":"2021-06-07T20:44:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----------+\n|edad|count(edad)|\n+----+-----------+\n| 115|          1|\n| 114|          2|\n| 113|          1|\n| 112|          1|\n| 111|          1|\n| 110|          4|\n| 109|          3|\n| 108|          8|\n| 107|         11|\n| 106|         20|\n| 105|         18|\n| 104|         39|\n| 103|         55|\n| 102|         69|\n| 101|        135|\n| 100|        195|\n|  99|        291|\n|  98|        441|\n|  97|        509|\n|  96|        698|\n+----+-----------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=395","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=396"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1623097416176_1728589906","id":"20210607-202336_1850525686","dateCreated":"2021-06-07T20:23:36+0000","dateStarted":"2021-06-07T20:44:09+0000","dateFinished":"2021-06-07T20:44:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3443"},{"text":"%spark2.pyspark\n#4.5 Contagio por SEXO\ndfsexo = spark.sql(\"SELECT Sexo, COUNT(Sexo) FROM covidcolombia GROUP BY Sexo ORDER BY COUNT(Sexo) DESC LIMIT 2\")\ndfsexo.show()\nwrite_uri='hdfs:///user/jflondonog/lab4/4.5_csv'\ndfsexo.coalesce(1).write.format(\"csv\").option(\"header\",\"true\").save(write_uri)","user":"jflondonog","dateUpdated":"2021-06-07T20:54:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----------+\n|Sexo|count(Sexo)|\n+----+-----------+\n|   F|    1749504|\n|   M|    1613552|\n+----+-----------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=399","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=400"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1623097508717_588814485","id":"20210607-202508_592236455","dateCreated":"2021-06-07T20:25:08+0000","dateStarted":"2021-06-07T20:44:25+0000","dateFinished":"2021-06-07T20:44:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3444"},{"text":"%spark2.pyspark\n#4.5 Cantidad de Hombres y Mujeres contagiados de mayor a menor en las ciudades de Colombia\ndfseci = spark.sql(\"SELECT ciudad, Sexo, COUNT(*) FROM covidcolombia GROUP BY ciudad, Sexo ORDER BY COUNT(*) DESC LIMIT 10\")\ndfseci.show()\nwrite_uri='hdfs:///user/jflondonog/lab4/4.5Extra_csv'\ndfseci.coalesce(1).write.format(\"csv\").option(\"header\",\"true\").save(write_uri)","user":"jflondonog","dateUpdated":"2021-06-07T20:56:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+----+--------+\n|      ciudad|Sexo|count(1)|\n+------------+----+--------+\n|      BOGOTA|   F|  506094|\n|      BOGOTA|   M|  444984|\n|    MEDELLIN|   F|  161273|\n|    MEDELLIN|   M|  140758|\n|        CALI|   F|   97486|\n|BARRANQUILLA|   F|   89013|\n|        CALI|   M|   88733|\n|BARRANQUILLA|   M|   83282|\n|   CARTAGENA|   F|   42065|\n|   CARTAGENA|   M|   40100|\n+------------+----+--------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=435","http://sandbox-hdp.hortonworks.com:4040/jobs/job?id=436"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1623098191656_-1104591839","id":"20210607-203631_2002144607","dateCreated":"2021-06-07T20:36:31+0000","dateStarted":"2021-06-07T20:56:07+0000","dateFinished":"2021-06-07T20:56:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3445"},{"text":"%spark2.pyspark\n","user":"jflondonog","dateUpdated":"2021-06-07T20:54:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1623099295016_-716569710","id":"20210607-205455_2020343490","dateCreated":"2021-06-07T20:54:55+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3446"}],"name":"jflondonog/lab4","id":"2G9FM95FD","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}